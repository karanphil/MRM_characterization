# wdir="/home/pkaran/Samsung/data/MT_Diffusion/myelo_inferno";
# wdir="/home/local/USHERBROOKE/karp2601/Samsung/data/MT_Diffusion/myelo_inferno";
wdir="/home/local/USHERBROOKE/karp2601/data/stockage/MT_Diffusion/myelo_inferno";
# source_dir="source";
source_dir="Research/source";
cd ${wdir}/DTI_metrics;
all_dirs=(sub*);
cd $wdir;
bin_width=1;
poly_order=8;
for sub in "${all_dirs[@]}";
    do echo $sub;
    mkdir -p "corrected_measures_new_nufo/${sub}/new_characterization";
    python ~/${source_dir}/MRM_characterization/scripts/scil_characterize_orientation_dependence.py FODF_metrics/${sub}/new_peaks/peaks.nii.gz  FODF_metrics/${sub}/new_peaks/peak_values.nii.gz DTI_metrics/${sub}/${sub}__dti_fa.nii.gz FODF_metrics/${sub}/new_peaks/nufo.nii.gz wm_mask/${sub}/${sub}__wm_mask.nii.gz corrected_measures_new_nufo/${sub}/new_characterization --measures ihMT/${sub}/${sub}__MTR_warped.nii.gz ihMT/${sub}/${sub}__ihMTR_warped.nii.gz ihMT/${sub}/${sub}__MTsat_warped.nii.gz ihMT/${sub}/${sub}__ihMTsat_warped.nii.gz --in_e1 DTI_metrics/${sub}/${sub}__dti_evecs_v1.nii.gz --measures_names MTR ihMTR MTsat ihMTsat --save_npz_files --bin_width_1f $bin_width --poly_order $poly_order --use_weighted_polyfit --scale_poly_order --min_nb_voxels 1 --compute_three_fiber_crossings;
done;